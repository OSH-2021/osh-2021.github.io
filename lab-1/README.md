# Lab 1

## 实验内容

- 了解树莓派的启动原理和过程
- 编译适用于树莓派的内核
- 构建初始内存盘
- 裁剪内核并在 QEMU 或树莓派中测试
- ???

## 实验要求

提醒: 编译一次内核的时间可能较久, 建议合理安排时间, 不要当 ddl 人.

### 准备工作

- Linux 环境和基本使用
- 使用 git 管理自己的实验目录
- 创建 GitHub 私有仓库并提交
- 了解树莓派启动的基本过程

推荐先阅读 lab0 内容 (Rust 相关可以暂缓).

### 目录结构

```
.                         // Git 根目录
├── lab1                  // 实验一根目录
│   ├── docs              // 实验一实验报告根目录
│   │   └── *.md          // 文件名自拟，可以写在一个或多个 Markdown 文件中
│   ├── linux
│   │   ├── Image         // 内核文件
│   │   ├── initrd.cpio.gz// 初始内存盘压缩文件
│   │   ├── .config       // 内核编译配置文件
|   |   └── src
|   |       └── init.c    // 如果 init 是 binary, 在此处提交源码
│   └── ???
│       └── ???
├── .gitignore            // 使用此文件忽略你不想提交的文件   
└── README.md             // 写入姓名学号
```

### 评分标准

本次实验共 10 分:

- Git & GitHub 仓库:
  - 正确创建了 `OSH-2021-TA` 这个 GitHub 用户能访问的 private 仓库 `OSH-2021-Labs`.
  - 正确使用 git. 没有通过 GitHub 网页版大量上传文件; 合理进行版本管理, 不要在一两个 commit 中提交所有文件; commit message 具有一定可读性; 符合目录结构要求. (0.5 分)
- Linux 内核:
  - 正确编译出适用于树莓派的内核 (0.5 分)
  - 内核裁剪过, 并且大小不超过 10 MiB, 并且它可以完成以下「初始内存盘」中的全部任务, 如果你没有完成「初始内存盘」中的全部任务，助教会使用自己的  `initrd.cpio.gz` 文件进行测试) (1 分)
  - 在上一条的基础上，裁剪得到的内核大小不超过 6 MiB (0.5 分)
- 初始内存盘:
  - 正确构建了 `initrd.cpio.gz` 文件. (0.5 分)
  - 使用你编译的内核和 `initrd.cpio.gz`，其中的 `/init` 能够成功依次执行助教提供的程序 1 (0.5 分)
  - 使用你编译的内核和 `initrd.cpio.gz`，其中的 `/init` 能够成功依次执行助教提供的程序 1、2、3, 程序 3 执行完成后不出现内核恐慌 (Kernel Panic) (1 分)
- ???
- 思考题:
  - 在下面给出的思考题中任选 3 道并完成它们 (1.5 分)

## 思考题:

1. 简述树莓派启动的过程 (包含各个阶段)
2. 为什么实验用树莓派上通过 GPIO 使用串口用的是 miniUART.

TBA
